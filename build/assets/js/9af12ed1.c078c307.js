/*! For license information please see 9af12ed1.c078c307.js.LICENSE.txt */
"use strict";(self.webpackChunkweb_totals=self.webpackChunkweb_totals||[]).push([[9072],{37746:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=o(85893),n=o(11151);const a={title:"Scroll Restoration in Nextjs",authors:"hunghg",tags:["Nextjs","Scroll Restoration"],image:"https://decodenatura.com/static/fb8aa1bb70c9925ce1ae22dc2711b343/nextjs-logo.png"},l=void 0,s={permalink:"/blog/scroll-restoration-nextjs",editUrl:"https://github.com/hunghg255/web-totals/tree/main/blog/scroll-restoration-nextjs.md",source:"@site/blog/scroll-restoration-nextjs.md",title:"Scroll Restoration in Nextjs",description:"Experimental scroll restoration flag",date:"2023-04-07T11:04:02.000Z",formattedDate:"April 7, 2023",tags:[{label:"Nextjs",permalink:"/blog/tags/nextjs"},{label:"Scroll Restoration",permalink:"/blog/tags/scroll-restoration"}],readingTime:1.345,hasTruncateMarker:!0,authors:[{name:"Gia Hung",title:"Creator of Web totals",url:"https://github.com/hunghg255",email:"giahung197bg@gmail.com",imageURL:"https://res.cloudinary.com/hunghg255/image/upload/v1654956015/Screen_Shot_2022-06-07_at_11.25.34_bpnymt.png",key:"hunghg"}],frontMatter:{title:"Scroll Restoration in Nextjs",authors:"hunghg",tags:["Nextjs","Scroll Restoration"],image:"https://decodenatura.com/static/fb8aa1bb70c9925ce1ae22dc2711b343/nextjs-logo.png"},unlisted:!1,prevItem:{title:"HTML Input Type",permalink:"/blog/html-input"},nextItem:{title:"X\u1eed l\xfd form v\u1edbi Ant Design (Ph\u1ea7n 1)",permalink:"/blog/handle-form-antd-part-1"}},i={authorsImageUrls:[void 0]},c=[{value:"Experimental scroll restoration flag",id:"experimental-scroll-restoration-flag",level:2},{value:"next-router-scroll",id:"next-router-scroll",level:2},{value:"Completely disabling scroll restoration",id:"completely-disabling-scroll-restoration",level:2}];function h(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,n.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"experimental-scroll-restoration-flag",children:"Experimental scroll restoration flag"}),"\n",(0,r.jsxs)(t.p,{children:["Luckily, Next.js has an ",(0,r.jsx)(t.a,{href:"https://github.com/vercel/next.js/commit/38bd1a024cb25923d8ea15f269a7294d073684d8",children:"experimental scrollRestoration flag"})," that you can enable to automatically restore the scroll positions."]}),"\n",(0,r.jsxs)(t.p,{children:["You can enable it in your ",(0,r.jsx)(t.code,{children:"next.config.js"})," file this way:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:"title=next.config.js",children:"module.exports = {\n  experimental: {\n    scrollRestoration: true,\n  },\n};\n"})}),"\n",(0,r.jsx)(t.h2,{id:"next-router-scroll",children:"next-router-scroll"}),"\n",(0,r.jsxs)(t.p,{children:["There are some cases where you need to take control of how your application scroll is handled; namely, you may want to restore scroll when the user is navigating within your application pages, but you need to do extra work before or after the page has changed, either by using some sort of page transition or any other feature.\nIn these cases, I\u2019d suggest you give ",(0,r.jsx)(t.code,{children:"@moxy/next-router-scroll"})," a try: This package is built on top of ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/scroll-behavior",children:"scroll-behavior"})," and it actively listens to Next.js router events, writing the scroll values associated with the current location in the Session Storage and reading these values whenever ",(0,r.jsx)(t.code,{children:"updateScroll()"})," is called."]}),"\n",(0,r.jsx)(t.h2,{id:"completely-disabling-scroll-restoration",children:"Completely disabling scroll restoration"}),"\n",(0,r.jsx)(t.p,{children:"There\u2019s one inconsistency I noticed around not making scroll restoration work automatically in Next.js: by default, scroll restoration doesn\u2019t work when the navigation logic is being handled by JavaScript, but it works fine when it\u2019s handled by the browser (e.g.: on a full-refresh or while navigating with JavaScript disabled)."}),"\n",(0,r.jsxs)(t.p,{children:["So, in the rare occasions where you want to fully disable scroll restoration, remember to add this snippet to the ",(0,r.jsx)(t.code,{children:"<head>"})," of your project:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:"import Head from 'next/head';\n\nexport default function ScrollRestorationDisabler() {\n  return (\n    <Head>\n      {/* Tell the browser to never restore the scroll position on load */}\n      <script\n        dangerouslySetInnerHTML={{\n          __html: `history.scrollRestoration = \"manual\"`,\n        }}\n      />\n    </Head>\n  );\n}\n"})})]})}function d(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},75251:(e,t,o)=>{var r=o(67294),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,o){var r,a={},c=null,h=null;for(r in void 0!==o&&(c=""+o),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(h=t.ref),t)l.call(t,r)&&!i.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:h,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},85893:(e,t,o)=>{e.exports=o(75251)},11151:(e,t,o)=>{o.d(t,{Z:()=>s,a:()=>l});var r=o(67294);const n={},a=r.createContext(n);function l(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);